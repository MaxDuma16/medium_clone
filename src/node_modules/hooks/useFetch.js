import {useState, useEffect} from 'react';
import axios from 'axios';

export default url => {
    const baseUrl = 'http://localhost:3000';
    const [isLoading, setIsLoading] = useState(false);
    const [response, setResponce] = useState(null);
    const [error, setError] = useState(null);
    const [options, setOptions] = useState({});

 const doFetch = (options = {}) => {
     setOptions(options);
     setIsLoading(true);
 };

 useEffect(() => {
    if (!isLoading) {
        return
    }
    axios(baseUrl + url, options)
    .then(res => {
        console.log('success', res);
        setIsLoading(false);
        setResponce(res.data)
    }).catch(err => {
        console.log('error', err);
        setIsLoading(false);
        setError(error.response.data)
    })
}, [isLoading, options, url])

 return [{isLoading, response, error}, doFetch]

}